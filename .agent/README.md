# AI Coding Assistant Guidelines

## Our Stance on AI-Assisted Coding

**We do NOT discourage the use of AI coding assistants** (such as GitHub Copilot, Cursor, ChatGPT, Claude, or any vibecoding tools). In fact, we acknowledge that AI tools can significantly accelerate development and help with boilerplate code, documentation, and complex problem-solving.

**However**, using AI tools comes with **responsibility and accountability**. Code generated by AI must be:

1. **Understood** by the contributor
2. **Tested thoroughly** according to our standards
3. **Reviewed** as if you wrote it yourself
4. **Not blindly accepted** as "the best solution"

## Core Principles

### 1. Understand Before You Commit

**Never commit code you don't understand.**

- If AI generates code, **read it carefully** and ensure you understand:
  - What it does
  - Why it does it that way
  - How it fits into the existing architecture
  - What edge cases it handles (or doesn't handle)

- **Ask questions** if something is unclear:
  - Why does this approach work?
  - Are there alternative approaches?
  - What are the trade-offs?

### 2. Test Thoroughly

**AI-generated code is not exempt from testing requirements.**

All code (whether written by hand or AI-assisted) must:

- ✅ Pass all existing tests: `uv run pytest`
- ✅ Have appropriate unit tests with >80% coverage
- ✅ Pass linting: `uv run ruff check .`
- ✅ Pass type checking: `uv run mypy .`
- ✅ Follow our coding standards (see `ruff-mypy-pytest.md`)

**Do NOT:**
- ❌ Submit code that "looks right" without testing
- ❌ Skip tests because "AI wrote it, so it must be correct"
- ❌ Assume AI-generated code handles edge cases
- ❌ Ignore test failures because "the AI said it should work"

### 3. Review and Refactor

**AI-generated code often needs refinement.**

- **Review for:**
  - Adherence to project architecture (e.g., using `narwhals` instead of direct Pandas/Polars imports)
  - Consistency with existing code patterns
  - Proper error handling
  - Type hints completeness
  - Documentation (docstrings)

- **Refactor if needed:**
  - AI may generate generic solutions that don't fit our specific architecture
  - AI may not be aware of our conventions (e.g., lazy loading, resource management)
  - AI may suggest patterns that conflict with our principles

### 4. Take Ownership

**You are responsible for the code you submit, regardless of how it was created.**

- If AI generates code that breaks something, **you are accountable**
- If AI generates code that doesn't follow our standards, **you must fix it**
- If AI generates code that works but is hard to understand, **you must document or refactor it**

**Do NOT:**
- ❌ Blame AI for bugs or issues
- ❌ Use "the AI wrote it" as an excuse for poor code quality
- ❌ Submit code without understanding it and expect reviewers to fix it

## Best Practices When Using AI Tools

### 1. Use AI for the Right Tasks

**Good use cases:**
- ✅ Generating boilerplate code (with review)
- ✅ Writing tests (with verification)
- ✅ Documentation and docstrings
- ✅ Refactoring suggestions
- ✅ Debugging help
- ✅ Learning new patterns or APIs

**Not ideal for:**
- ❌ Architectural decisions (these require human judgment)
- ❌ Complex business logic without understanding
- ❌ Code that must follow specific project conventions
- ❌ Security-critical code without thorough review

### 2. Iterate and Improve

**AI suggestions are starting points, not final solutions.**

1. **Generate** initial code with AI
2. **Review** for correctness and adherence to standards
3. **Test** thoroughly
4. **Refactor** to match project conventions
5. **Document** any non-obvious decisions
6. **Verify** all checks pass before committing

### 3. Learn from AI Suggestions

**Use AI as a learning tool, not a crutch.**

- When AI suggests a pattern, **understand why** it works
- When AI uses a library feature, **read the documentation** to understand it fully
- When AI suggests an optimization, **verify it actually improves performance**

## Code Review Expectations

**Reviewers will hold AI-assisted code to the same standards as hand-written code.**

When reviewing PRs with AI-assisted code, reviewers will check:

1. ✅ Does the code follow our architecture guidelines?
2. ✅ Are there appropriate tests?
3. ✅ Does it pass all quality checks (ruff, mypy, pytest)?
4. ✅ Is the code understandable and maintainable?
5. ✅ Are there proper type hints and documentation?

**If any of these fail, the PR will be requested for changes, regardless of whether AI was used.**

## Examples: Good vs. Bad AI Usage

### ❌ Bad: Blind Acceptance

```python
# AI generated this, looks good, let's commit it!
def clean_data(df):
    return df.dropna()
```

**Problems:**
- No type hints
- No error handling
- Doesn't use `narwhals` (violates architecture)
- No tests
- Doesn't follow our API patterns

### ✅ Good: AI-Assisted with Review

```python
# AI suggested the structure, but I:
# 1. Added proper type hints
# 2. Used narwhals for backend-agnosticism
# 3. Added error handling
# 4. Wrote tests
# 5. Followed our API patterns

from narwhals import from_native
from narwhals.typing import IntoFrameT

def clean_data(df: IntoFrameT, target_col: str) -> IntoFrameT:
    """Clean data by removing null values from target column."""
    nw_df = from_native(df)
    return nw_df.drop_nulls(subset=[target_col]).to_native()
```

## Final Reminder

**AI tools are powerful assistants, but they are not substitutes for:**

- Understanding the codebase
- Understanding the problem domain
- Writing tests
- Following project conventions
- Taking responsibility for code quality

**Use AI to accelerate your work, not to avoid it.**

## Questions?

If you're unsure about whether AI-generated code meets our standards:

1. **Test it thoroughly** - Run all quality checks
2. **Review it yourself** - Would you be comfortable maintaining this code?
3. **Ask for help** - Open a draft PR or ask in discussions
4. **Iterate** - Use feedback to improve the code

Remember: **Good code is good code, regardless of how it was created. Bad code is bad code, regardless of who (or what) wrote it.**
